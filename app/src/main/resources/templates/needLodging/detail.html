<!DOCTYPE html>
<html lang="en">
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ìˆ™ì†Œê°€ í•„ìš”í•´ ìƒì„¸ í˜ì´ì§€</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link href="/css/main/header.css" rel="stylesheet" type="text/css" />
  <link href="/css/main/footer.css" rel="stylesheet" type="text/css" />
  <link href="/css/needLodging/detail.css" rel="stylesheet" type="text/css" />
</head>
<body>
<header th:replace="/main/header.html::topHeader(memberNumber = ${session.memberNumber}, memberNickname = ${session.memberNickname})"></header>
<header th:replace="/main/header.html :: #header"></header>

<div class="detail-page-wrapper">
  <div class="detail-page">
    <div class="detail-page-container">
      <div class="header-section">
        <div class="header-image-section" th:object="${lodgingDTO}">
          <!--<img src="https://res.cloudinary.com/frientrip/image/upload/ar_1:1,c_fill,dpr_2,f_auto,q_auto,w_375/1706_masteringdrum_main2_1498628756023_1499650725964"
               class="header-image" alt="ìƒì„¸ í—¤ë” ì´ë¯¸ì§€">-->
          <th:block th:if="${not #strings.isEmpty(lodgingDTO.fileLodgingVO)}">
            <!--<h1>íŒŒì¼ì•ˆë¹„ì–´ìˆì§€ë¡±</h1>
            <h1 th:text="${meetDTO.fileMeetVO.fileUploadPath} + '/' + ${meetDTO.fileMeetVO.fileUuid} + '_' + ${meetDTO.fileMeetVO.fileName}"></h1>-->
            <img th:if="${lodgingDTO.fileLodgingVO.fileImageCheck}" th:src="@{/fileLodging/display(fileName=${lodgingDTO.fileLodgingVO.fileUploadPath} + '/' + ${lodgingDTO.fileLodgingVO.fileUuid} + '_' + ${lodgingDTO.fileLodgingVO.fileName})}" class="profile-image" />
            <img th:unless="${lodgingDTO.fileLodgingVO.fileImageCheck}" src="/images/noImage/no-image.jpg" class="profile-image" />
          </th:block>
          <th:block th:unless="${not #strings.isEmpty(lodgingDTO.fileLodgingVO)}">
            <!-- <h1>íŒŒì¼ë¹„ì–´ìˆì§€ë¡±</h1>-->
            <img src="/images/noImage/no-image.jpg"  class="profile-image">
          </th:block>
        </div>
        <div class="header-info">
          <div class="header-info-basic">
            <div class="header-info-title">
              <!--<h1 class="title-content">ìˆ™ì†Œê°€ í•„ìš”í•´ ì œëª©</h1>-->
              <h1 class="title-content" th:text="${lodgingDTO.lodgingTitle}"></h1>
            </div>
            <div class="header-info-date">
              <!--<p class="date-content" >2022.11.18 4:56</p>-->
              <p class="date-content" th:text="${lodgingDTO.lodgingUpdateDate}"></p>
            </div>
            <div class="post-button-wrapper">
              <th:block th:if="${session.memberNumber == lodgingDTO.memberNumber}">
                <button class="post-button" id="updateButton">ìˆ˜ì •</button>
                <button class="post-button" id="removeButton">ì‚­ì œ</button>
              </th:block>

              <th:block th:unless="${session.memberNumber == lodgingDTO.memberNumber}">

              </th:block>
            </div>
          </div>
          <div class="select-box">
            <!--<h1 class="title-content2 select-box-title">ë‚´ê°€ ìµìˆ™í•œ ì–¸ì–´ : í•œêµ­ì–´</h1>-->
            <h1 class="title-content2 select-box-title" th:text="'ë‚´ê°€ ìµìˆ™í•œ ì–¸ì–´ : '+${lodgingDTO.memberTeachingLang}"></h1>
          </div>
          <div class="select-box">
            <!--<h1 class="title-content2 select-box-title">ë„ì›€ì„ ì›í•˜ëŠ” ì–¸ì–´ : í”„ë‘ìŠ¤ì–´</h1>-->
            <h1 class="title-content2 select-box-title" th:text="'ë„ì›€ì„ ì›í•˜ëŠ” ì–¸ì–´ : '+${lodgingDTO.lodgingLearningLang}"></h1>
          </div>
          <div class="header-info-profile">
            <div class="profile-content-section">
              <div class="profile-image-section">
                <a href="#">
                  <div class="profile-image-wrapper">
                    <!--<img src="https://res.cloudinary.com/frientrip/image/upload/ar_1:1,c_fill,dpr_2,f_auto,q_auto,w_56/576_blueguitar_1476154324950"
                         class="profile-image" alt="í”„ë¡œí•„ ì´ë¯¸ì§€">-->
                    <th:block th:if="${not #strings.isEmpty(lodgingDTO.fileProfileVO)}">
                      <img th:if="${lodgingDTO.fileProfileVO.fileImageCheck}" th:src="@{/fileProfile/display(fileName=${lodgingDTO.fileProfileVO.fileUploadPath} + '/' + ${lodgingDTO.fileProfileVO.fileUuid} + '_' + ${lodgingDTO.fileProfileVO.fileName})}" class="profile-image" />
                      <img th:unless="${lodgingDTO.fileProfileVO.fileImageCheck}" src="/images/noImage/no-image.jpg" class="profile-image" />
                    </th:block>
                    <th:block th:unless="${not #strings.isEmpty(lodgingDTO.fileProfileVO)}">
                      <img src="/images/noImage/no-image.jpg"  class="profile-image">
                    </th:block>
                  </div>
                </a>
              </div>
              <div class="profile-content">
                <div class="profile-name">
                  <a href="#">
                      <span class="profile-name-content">
                        <!--<span>ë¸”ë£¨ê¸°íƒ€</span>-->
                        <span  th:if="${lodgingDTO.memberNickname}" th:text="${lodgingDTO.memberNickname}"></span>
                        <span  th:unless="${lodgingDTO.memberNickname}" >ë¸”ë£¨ê¸°íƒ€</span>
                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='none' viewBox='0 0 16 16'%3E %3Cpath stroke='%23333' stroke-linecap='round' stroke-width='1.5' d='M6 3l5 5-5 5'/%3E %3C/svg%3E" alt="">
                      </span>
                  </a>
                </div>
                <!--<span class="profile-plus">ì‘ì„±ì ë‚˜ë¼..?</span>-->
                <span class="profile-plus"  th:if="${lodgingDTO.memberTeachingLang}" th:text="${lodgingDTO.memberTeachingLang}"></span>
                <span class="profile-plus"  th:unless="${lodgingDTO.memberTeachingLang}" >ì‘ì„±ì ë‚˜ë¼..?</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <section class="section">
        <article>
          <h2 class="article-title">ë‚´ìš©</h2>
          <div class="article-content">
            <!--<div>í›„ê¸°ë¥¼ ë³´ì‹œë©´ ì•„ì‹œê² ì§€ë§Œ í”„ë¦½ì—ì„œ ëŒ€ì›ë“¤ë¡œë¶€í„° ìƒë‹¹íˆ ë§Œì¡±ë„ê°€ ë†’ì€ í´ë˜ìŠ¤ëë‹ˆë‹¤ ^^* ( í›„ê¸° ì¨ì£¼ì‹  ëŒ€ì›ë‹˜ë“¤ ê°ì‚¬í•´ìš”! )
              í›„ê¸°ë¥¼ ë³´ì‹œë©´ ì•„ì‹œê² ì§€ë§Œ í”„ë¦½ì—ì„œ ëŒ€ì›ë“¤ë¡œë¶€í„° ìƒë‹¹íˆ ë§Œì¡±ë„ê°€ ë†’ì€ í´ë˜ìŠ¤ëë‹ˆë‹¤ ^^* ( í›„ê¸° ì¨ì£¼ì‹  ëŒ€ì›ë‹˜ë“¤ ê°ì‚¬í•´ìš”! )
              í›„ê¸°ë¥¼ ë³´ì‹œë©´ ì•„ì‹œê² ì§€ë§Œ í”„ë¦½ì—ì„œ ëŒ€ì›ë“¤ë¡œë¶€í„° ìƒë‹¹íˆ ë§Œì¡±ë„ê°€ ë†’ì€ í´ë˜ìŠ¤ëë‹ˆë‹¤ ^^* ( í›„ê¸° ì¨ì£¼ì‹  ëŒ€ì›ë‹˜ë“¤ ê°ì‚¬í•´ìš”! )
              í›„ê¸°ë¥¼ ë³´ì‹œë©´ ì•„ì‹œê² ì§€ë§Œ í”„ë¦½ì—ì„œ ëŒ€ì›ë“¤ë¡œë¶€í„° ìƒë‹¹íˆ ë§Œì¡±ë„ê°€ ë†’ì€ í´ë˜ìŠ¤ëë‹ˆë‹¤ ^^* ( í›„ê¸° ì¨ì£¼ì‹  ëŒ€ì›ë‹˜ë“¤ ê°ì‚¬í•´ìš”! )</div>-->
            <div th:text="${lodgingDTO.lodgingContent}"></div>
          </div>
        </article>
      </section>

      <section class="section">
        <h2 class="article-title">ì¥ì†Œ</h2>
        <div class="map-wrapper">
          <div id="map" style="width:100%;height:150px;"></div>
          <div class="map-info">
            <div class="map-info-wrapper">
              <!--<strong class="map-info-content">ì„œìš¸ì‹œ ì˜ë“±í¬êµ¬ ë‹¹ì‚°ë¡œ30ê¸¸ 6 3ì¸µ ë¸”ë£¨ê¸°íƒ€ ì‹¤ìš©ìŒì•…í•™ì›</strong>-->
              <strong class="map-info-content" th:text="${lodgingDTO.lodgingAddress}+' '+${lodgingDTO.lodgingDetailAddress}"></strong>
            </div>
          </div>
        </div>
      </section>

      <section class="section">
        <article>
          <h2 class="article-title" th:text="'ë‹µê¸€ :' +${answerCount}"></h2>
          <div class="comment-reg-section">
            <textarea class="comment-reg" id="inputWriteAnswer" placeholder="ë‹µê¸€ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
            <div class="comment-button">
              <button class="post-button" id="firstWriteAnswer">ë“±ë¡</button>
            </div>
          </div>
          <div id="answerBody">

            <!--<div class="comment-section">
              <div class="profile-content-section">
                <div class="profile-image-section comment-profile-image-section">
                  <a href="#">
                    <div class="profile-image-wrapper">
                      <img src="https://res.cloudinary.com/frientrip/image/fetch/ar_1:1,c_fill,dpr_2,f_auto,q_auto,w_48/https://k.kakaocdn.net/dn/O9FAs/btrNYVcBVpk/y8Gfya3OiNsAWmSNkhysI1/img_110x110.jpg"
                           class="profile-image" alt="í”„ë¡œí•„ ì´ë¯¸ì§€">
                    </div>
                  </a>
                </div>
                <div class="profile-content">
                  <div class="profile-name">
                    <a href="#">
                        <span class="comment-name profile-name-content">
                          <span>ë¥˜ì‹œëª…</span>
                        </span>
                    </a>
                  </div>
                  <span class="comment-date">2022ë…„ 10ì›” 22ì¼ 0:15 ì‘ì„±</span>
                  <div class="post-button-wrapper comment-button">
                    <button class="post-button" style="margin-right: 4px;">ìˆ˜ì •</button>
                    <button class="post-button">ì‚­ì œ</button>
                  </div>
                </div>
              </div>
              <div class="comment-content">ì›ë°ì´ í´ë˜ì“°ë¥¼ ì²˜ìŒ ê°€ë´¤ëŠ”ë° ì™œ ì´ì œì•¼ ê°€ë´¤ë‚˜ ì‹¶ì„ ì •ë„ë¡œ ì •ë§ ì¬ë°Œì—ˆìŠµë‹ˆë‹¤. ë“œëŸ¼ ê¸°ë³¸ê¸° ë¶€í„° ê¼¼ê¼¼íˆ ê°€ë¥´ì³ì£¼ì…”ì„œ ëˆ„êµ¬ë‚˜ ë”°ë¼í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ì•„ìš”! ì—°ìŠµí•  ìˆ˜ ìˆëŠ” ì‹œê°„ì„ ì¶©ë¶„íˆ ì£¼ì…”ì„œ ì‚´ì§ ë³€í˜• ë¦¬ë“¬ë„ ì¹˜ë‹ˆ ìŠ¤ìŠ¤ë¡œ ë“œëŸ¼ ì˜ ì¹˜ëŠ” ì‚¬ëŒ ê°™ì€ ê¸°ë¶„ë„ ë“¤ë”ë¼êµ¬ìš”ã…ã…ã…ğŸ‘ğŸ‘ ë˜ ì˜ìƒë„ ì •ì„±ë“¤ì—¬ ì°ì–´ì£¼ì…¨ëŠ”ë° ì¹´ë©”ë¼ ë¬´ë¹™ì´ ì¥ë‚œ ì•„ë‹ˆì…”ì„œ ë³´ë©´ì„œ ì›ƒì—ˆìŠµë‹ˆë‹¤^_^ ì´ì œ ë§¨ë‚  ì¹˜ê³  ì‹¶ì–´ì§ˆ ê²ƒ ê°™ì•„ìš”...ã… </div>
              <div class="comment-button">
                <button class="post-button reply-register">ëŒ“ê¸€</button>
              </div>
              <div class="comment-reply">
                <div class="reply-section">
                  <div class="comment-reg-section reply-toggle">
                    <textarea class="comment-reg" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                    <div class="comment-button">
                      <button class="post-button">ë“±ë¡</button>
                    </div>
                  </div>

                  -->

          </div>
        </article>
        <div class="paging">

        </div>
      </section>
    </div>
  </div>
</div>

<footer th:replace="/main/footer.html :: #footerFirst"></footer>

</body>
<!--geocoder ì¸ì‹ì„ ìœ„í•´ ë°˜ë“œì‹œ libraries=servicesë¥¼ ë§¨ìœ„ì— ë„£ëŠ”ë‹¤.-->
<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=2dedcb5b9a8bf1a8785a7e1907f9c2bd&libraries=services"></script>
<script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=2dedcb5b9a8bf1a8785a7e1907f9c2bd"></script>
<script src="/js/lodging/lodgingAnswerAjax.js"></script>
<script src="/js/lodging/lodgingAnswerCommentAjax.js"></script>
<script th:inline="javascript">
    var mapContainer = document.getElementById('map'), // ì§€ë„ë¥¼ í‘œì‹œí•  div
        mapOption = {
            center: new kakao.maps.LatLng(33.450701, 126.570667), // ì§€ë„ì˜ ì¤‘ì‹¬ì¢Œí‘œ
            level: 3 // ì§€ë„ì˜ í™•ëŒ€ ë ˆë²¨
        };

    // ì§€ë„ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
    var map = new kakao.maps.Map(mapContainer, mapOption);

    // ì£¼ì†Œ-ì¢Œí‘œ ë³€í™˜ ê°ì²´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
    var geocoder = new kakao.maps.services.Geocoder();

    let lodgingAddress = [[${lodgingDTO.lodgingAddress}]];
    let lodgingDetailAddress = [[${lodgingDTO.lodgingDetailAddress}]];
    let lodgingFullAddress = lodgingAddress + lodgingDetailAddress;
    console.log(lodgingFullAddress);

    // ì£¼ì†Œë¡œ ì¢Œí‘œë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤
    //ìƒì„¸ ì£¼ì†ŒëŠ” ì• ë§¤í•˜ë‹ˆê¹Œ ë¹¼ê³  í™•ì‹¤í•œ ì£¼ì†Œë¥¼ geocoderì— ë„£ì–´ì•¼ ë§µì— ì •ìƒì ìœ¼ë¡œ ë‚˜ì˜´
    geocoder.addressSearch(lodgingAddress, function(result, status) {

        // ì •ìƒì ìœ¼ë¡œ ê²€ìƒ‰ì´ ì™„ë£Œëìœ¼ë©´
        if (status === kakao.maps.services.Status.OK) {

            var coords = new kakao.maps.LatLng(result[0].y, result[0].x);

            // ê²°ê³¼ê°’ìœ¼ë¡œ ë°›ì€ ìœ„ì¹˜ë¥¼ ë§ˆì»¤ë¡œ í‘œì‹œí•©ë‹ˆë‹¤
            var marker = new kakao.maps.Marker({
                map: map,
                position: coords
            });

            // // ì¸í¬ìœˆë„ìš°ë¡œ ì¥ì†Œì— ëŒ€í•œ ì„¤ëª…ì„ í‘œì‹œí•©ë‹ˆë‹¤
            // var infowindow = new kakao.maps.InfoWindow({
            //     content: '<div style="width:150px;text-align:center;padding:6px 0;">ìš°ë¦¬íšŒì‚¬</div>'
            // });
            // infowindow.open(map, marker);

            // ì§€ë„ì˜ ì¤‘ì‹¬ì„ ê²°ê³¼ê°’ìœ¼ë¡œ ë°›ì€ ìœ„ì¹˜ë¡œ ì´ë™ì‹œí‚µë‹ˆë‹¤
            map.setCenter(coords);
        }
    });

    let lodgingNumber=[[${lodgingDTO.lodgingNumber}]];
    $("button#updateButton").on("click",function(){
      location.href='/needLodging/writeUpdate?lodgingNumber='+lodgingNumber;
    });
    $("button#removeButton").on("click",function(){
      location.href='/needLodging/writeRemove?lodgingNumber='+lodgingNumber;
    });
</script>
<script th:inline="javascript">
  globalThis.page = 1;
  getList();

  function getList() {
    lodgingAnswerAjax.getList({
      lodgingNumber: lodgingNumber,
      page: globalThis.page
    },showList);
  }

  function showList(answers){
    let answertext="";
    answers.lodgingAnswerDTOList.forEach(lodgingAnswerDTO=>{
      console.log("íŒŒì¼ì—…ë¡œë“œíŒ¨ìŠ¤"+lodgingAnswerDTO.fileUploadPath);
      console.log("íŒŒì¼ìœ ìœ ì•„ì´ë””"+lodgingAnswerDTO.fileUuid);
      console.log("íŒŒì¼ë„¤ì„"+lodgingAnswerDTO.fileName);
      answertext+='<div class="comment-section">';
      answertext+='<div class="profile-content-section">';
      answertext+='<div class="profile-image-section comment-profile-image-section">';
      answertext+='<a href="#">';
      answertext+='<div class="profile-image-wrapper">';
      answertext+='<img src="/fileProfile/display?fileName='+lodgingAnswerDTO.fileUploadPath + '/s_' + lodgingAnswerDTO.fileUuid + '_' + lodgingAnswerDTO.fileName+'"';
      answertext+='class="profile-image" alt="í”„ë¡œí•„ ì´ë¯¸ì§€">';
      /*answertext+='<img src="/images/noImage/noImgLittleProfile.png"';
      answertext+='class="profile-image" alt="í”„ë¡œí•„ ì´ë¯¸ì§€"/>';*/
      /* answertext+='<th:block th:if="${meetAnswerDTO.fileUploadPath != null}">';
       answertext+='<img th:if="${meetAnswerDTO.fileImageCheck}" th:src="@{/fileProfile/display(fileName=${meetAnswerDTO.fileUploadPath}+ `/s_`+ ${meetAnswerDTO.fileUuid}+ `_` +${meetAnswerDTO.fileName})}" class="profile-image" />';
       answertext+='<img th:unless="${meetAnswerDTO.fileImageCheck}" src="/images/nation/america.png" class="profile-image" />';
       answertext+='</th:block>';
       answertext+='<th:block th:unless="${meetAnswerDTO.fileUploadPath != null}">';
       answertext+='<img src="/images/nation/america.png"  class="profile-image" >';
       answertext+= '</th:block>';*/
      answertext+='</div>';
      answertext+='</a>';
      answertext+='</div>';
      answertext+='<div class="profile-content">';
      answertext+='<div class="profile-name">';
      answertext+='<a href="#">';
      answertext+='<span class="comment-name profile-name-content">';
      answertext+='<span>'+lodgingAnswerDTO.memberNickname+'</span>';
      answertext+='</span>';
      answertext+='</a>';
      answertext+='</div>';
      answertext+='<span class="comment-date">'+lodgingAnswerDTO.lodgingAnswerUpdateDate +'ì‘ì„±</span>';
      answertext+='<div class="post-button-wrapper comment-button">';
      answertext+='<button class="post-button '+lodgingAnswerDTO.lodgingAnswerNumber+' answerUpdate '+lodgingAnswerDTO.memberNumber+'" style="margin-right: 4px;">ìˆ˜ì •</button>';
      answertext+='<button class="post-button '+lodgingAnswerDTO.lodgingAnswerNumber+' answerRemove '+lodgingAnswerDTO.memberNumber+'">ì‚­ì œ</button>';
      answertext+='</div>';
      answertext+='</div>';
      answertext+='</div>';
      answertext+='<div class="comment-content comment-content'+lodgingAnswerDTO.lodgingAnswerNumber+'">'+lodgingAnswerDTO.lodgingAnswerContent+'</div>';
      //ì—¬ê¸°ì„œë¶€í„°ëŠ” ë‹¤ë¥¸êµ¬ì—­
      answertext+='<div class="comment-button">';
      answertext+='<button class="post-button reply-register  '+lodgingAnswerDTO.lodgingAnswerNumber+'">ëŒ“ê¸€</button>';
      answertext+='</div>';
      answertext+='<div class="comment-reply">';
      //replysection
      answertext+='<div class="reply-section" id="answer'+lodgingAnswerDTO.lodgingAnswerNumber+'">';
      answertext+='<div class="comment-reg-section reply-toggle'+lodgingAnswerDTO.lodgingAnswerNumber+' reply-toggle">';
      answertext+='<textarea class="comment-reg" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>';
      answertext+='<div class="comment-button">';
      answertext+='<button class="post-button  '+lodgingAnswerDTO.lodgingAnswerNumber+' commentWriteButton ">ë“±ë¡</button>';
      answertext+='</div>';
      answertext+='</div>';
      //ëŒ“ê¸€êµ¬ì—­
      //ê½‚ì•„ë„£ì„ê³³
      //answertext+='<div class="reply-content">';

      /*answertext+='<div class="profile-content-section">';
      answertext+='<div class="profile-image-section comment-profile-image-section">';
      answertext+='<a href="#">';
      answertext+='<div class="profile-image-wrapper">';
      answertext+='<img src="https://res.cloudinary.com/frientrip/image/upload/ar_1:1,c_fill,dpr_2,f_auto,q_auto,w_56/576_blueguitar_1476154324950"';
      answertext+='class="profile-image" alt="í”„ë¡œí•„ ì´ë¯¸ì§€">';
      answertext+='</div>';
      answertext+='</a>';
      answertext+='</div>';
      answertext+='<div class="profile-content">';
      answertext+='<div class="profile-name">';
      answertext+='<a href="#">';
      answertext+='<span class="comment-name profile-name-content">';
      answertext+='<span>ë¸”ë£¨ê¸°íƒ€</span>';
      answertext+='</span>';
      answertext+='</a>';
      answertext+='</div>';
      answertext+='<span class="comment-date">2022ë…„ 10ì›” 22ì¼ 0:15 ì‘ì„±</span>';
      answertext+='<div class="post-button-wrapper comment-button">';
      answertext+='<button class="post-button" style="margin-right: 4px;">ìˆ˜ì •</button>';
      answertext+='<button class="post-button">ì‚­ì œ</button>';
      answertext+='</div>';
      answertext+='</div>';*/
      //profilecontent ë
      //answertext+='</div>';
      //replycontent  ë
      //answertext+='<div>';

      //answertext+='í›„ê¸° ë„˜ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤ :) ìœ íŠœë¸Œë§Œ ë³´ê³  ê·¸ë ‡ê²Œ ì˜ ì¹  ìˆ˜ìˆëŠ”ê±´ì§€ ìƒˆë¡­ê²Œ ì•Œì•˜ë„¤ìš”ã…ã… ì˜ìƒ ì •ì„±ìŠ¤ëŸ½ê²Œ ì°ì—ˆìœ¼ë‹ˆ ì˜í™œìš©í•˜ì‹œêµ¬ìš” ã…ã… í˜¹ì‹œë‚˜ ë“±ë¡í•˜ì‹œë ¤ë©´ ì›ë°ì´ í‚¥ë² ë¦¬ì—ì´ì…˜ í–ˆë‹¤ê³  ì•Œë ¤ì£¼ì‹¬ ì¢‹ìœ¼ë‹ˆ ì°¸ê³ í•˜ì„¸ìš”^^';
      //answertext+='</div>';
      //ê½‚ì•„ë„£ì„ê³³ ë
      //answertext+='</div>';
      //replysection ë

      //ëŒ“ê¸€êµ¬ì—­ ë

      answertext+='</div>';
      answertext+='</div>';
      answertext+='</div>';

      //ë‚˜ë¨¸ì§€ êµ¬ì—­ ë

      commentGetList(lodgingAnswerDTO.lodgingAnswerNumber);

    });
    $("#answerBody").html(answertext);
    showAnswerPagenation(answers.lodgingAnswerCount);

  }

  function showAnswerPagenation(answerCount){
    let endNumber = Math.ceil(globalThis.page / 2) * 2;
    let startNumber = endNumber - 1;
    let realEnd = Math.ceil(answerCount / 2);

    if(endNumber > realEnd){
      endNumber = realEnd == 0 ? '1' : realEnd;
    }

    let prev = startNumber > 1;
    let next = endNumber < realEnd;

    let text = "";
    if(prev){
      text += `<a class="changePage" href="` + (startNumber - 1) + `"><code>PREV</code></a>`
    }
    for (let i=startNumber; i<=endNumber; i++){
      if(globalThis.page == i){
        text += `<code>` + i + `</code>`
        continue;
      }
      text += `<a class="changePage" href="` + i + `"><code>` + i + `</code></a>`
    }
    if(next){
      text += `<a class="changePage" href="` + (endNumber + 1) + `"><code>NEXT</code></a>`
    }
    $("div.paging").html(text);
  }


  $("div.paging").on("click", "a.changePage", function(e){
    e.preventDefault();
    globalThis.page = $(this).attr("href");
    getList();
  });


  function commentGetList(lodgingAnswerNumber){
    lodgingCommentAjax.getList(
            lodgingAnswerNumber,
            commentshowList,
            function(a, b, c){
              if(error){
                error(a, b, c);
              }
            }
    );
    console.log("commentGetListë“¤ì–´ì˜´");
    console.log(""+lodgingAnswerNumber);
  }
  function error(a,b,c){
    console.log(a,b,c);
  }
  function commentshowList(lodgingAnswerCommentDTOList){
    console.log(""+lodgingAnswerCommentDTOList);
    let commenttext="";
    let currentIndex;
    lodgingAnswerCommentDTOList.forEach(lodgingAnswerCommentDTO=>{
      console.log("íŒŒì¼ì—…ë¡œë“œíŒ¨ìŠ¤"+lodgingAnswerCommentDTO.fileUploadPath);
      console.log("íŒŒì¼ìœ ìœ ì•„ì´ë””"+lodgingAnswerCommentDTO.fileUuid);
      console.log("íŒŒì¼ë„¤ì„"+lodgingAnswerCommentDTO.fileName);
      commenttext+='<div class="reply-content"  id="comment">';
      commenttext+='<div class="profile-content-section">';
      commenttext+='<div class="profile-image-section comment-profile-image-section">';
      commenttext+='<a href="#">';
      commenttext+='<div class="profile-image-wrapper">';
      commenttext+='<img src="/fileProfile/display?fileName='+lodgingAnswerCommentDTO.fileUploadPath + '/s_' + lodgingAnswerCommentDTO.fileUuid + '_' + lodgingAnswerCommentDTO.fileName+'"';
      commenttext+='class="profile-image" alt="í”„ë¡œí•„ ì´ë¯¸ì§€">';
      commenttext+='</div>';
      commenttext+='</a>';
      commenttext+='</div>';
      commenttext+='<div class="profile-content">';
      commenttext+='<div class="profile-name">';
      commenttext+='<a href="#">';
      commenttext+='<span class="comment-name profile-name-content">';
      commenttext+='<span>'+lodgingAnswerCommentDTO.memberNickname+'</span>';
      commenttext+='</span>';
      commenttext+='</a>';
      commenttext+='</div>';
      commenttext+='<span class="comment-date">'+lodgingAnswerCommentDTO.lodgingCommentUpdateDate+'</span>';
      commenttext+='<div class="post-button-wrapper comment-button">';
      commenttext+='<button class="post-button '+lodgingAnswerCommentDTO.lodgingAnswerCommentNumber+ ' commentUpdateButton '+lodgingAnswerCommentDTO.memberNumber+'" style="margin-right: 4px;">ìˆ˜ì •</button>';
      commenttext+='<button class="post-button '+lodgingAnswerCommentDTO.lodgingAnswerCommentNumber+ ' commentRemoveButton '+lodgingAnswerCommentDTO.memberNumber+'">ì‚­ì œ</button>';
      commenttext+='</div>';
      commenttext+='</div>';
      commenttext+='</div>';
      commenttext+='<div class="comment-text  comment-text'+lodgingAnswerCommentDTO.lodgingAnswerCommentNumber+'">';
      commenttext+=lodgingAnswerCommentDTO.lodgingAnswerCommentContent;
      commenttext+='</div>';
      commenttext+='</div>';

      currentIndex=lodgingAnswerCommentDTO.lodgingAnswerNumber;
    });

    $('#answer'+currentIndex).append(commenttext);
    console.log(commenttext);
  }

</script>
<script th:inline="javascript">
  let flagRegister=true;
  let answerModifyCheck=true;
  let currentModifyingAnswerNumber=0;
  let writeAnswerLodgingNumber=[[${lodgingDTO.lodgingNumber}]];
  let commentModifyCheck=true;
  let currentModifyingCommentNumber=0;
  let sessionMemberNumber=[[${session.memberNumber}]];

  $(document).ready(function () {
    $("#answerBody").on("click", ".reply-register", function () {
      console.log("ë¦¬í”Œë¼ì´ë¦¬ì§€ìŠ¤í„°ë“¤ì–´ê°");
      let registerClickNumber = this.classList[2];
      //$('.reply-toggle'+registerClickNumber).toggle();
      //console.log($("#answerBody.reply-toggle"));
      if (flagRegister) {
        $('.reply-toggle' + registerClickNumber).show();
        flagRegister = false;
      } else {
        $('.reply-toggle' + registerClickNumber).hide();
        flagRegister = true;
      }
    });


    //ë‹µê¸€ ìˆ˜ì •ë²„íŠ¼ ëˆ„ë¥´ë©´
    $("#answerBody").on("click", ".answerUpdate", function () {
      if(sessionMemberNumber!=this.classList[3]){
        alert("ì‘ì„±ìê°€ ì•„ë‹ˆë¯€ë¡œ ìˆ˜ì • ëª»í•©ë‹ˆë‹¤");
      }
      else if (answerModifyCheck == false && currentModifyingAnswerNumber != this.classList[1]) {
        alert("ìˆ˜ì •ì¤‘ì¸ ë‹µê¸€ì´ ìˆìŠµë‹ˆë‹¤.");
        return;
      }
      else if (currentModifyingAnswerNumber == 0) {
        currentModifyingAnswerNumber = this.classList[1];

        answerModifyCheck = false;


        $(".comment-content" + currentModifyingAnswerNumber).replaceWith("<textarea  style='resize:none;'  class='comment-content  comment-content" + currentModifyingAnswerNumber + "'>" + $(".comment-content" + currentModifyingAnswerNumber).text() + "</textarea>");
      } else {
        lodgingAnswerAjax.modify({
          lodgingAnswerNumber: currentModifyingAnswerNumber,
          lodgingAnswerContent: $("textarea.comment-content" + currentModifyingAnswerNumber).val()
        }, function () {
          getList();
          answerModifyCheck = true;
        });

        currentModifyingAnswerNumber = 0;
      }

    });
    //ë‹µê¸€ ì“°ê¸°ë²„íŠ¼
    $("#firstWriteAnswer").on("click", function () {
      console.log("firstwriteanswerë“¤ì–´ì˜´");
      let lodgingAnswerContent = $("#inputWriteAnswer").val();
      console.log($("#inputWriteAnswer").val());
      console.log(lodgingAnswerContent);

      if(lodgingAnswerContent==''){
        alert("ì…ë ¥í•œ ë‚´ìš©ì´ ì•„ë¬´ê²ƒë„ ì—†ìŠµë‹ˆë‹¤");
        return;
      }
      else {
        lodgingAnswerAjax.add({
                  lodgingNumber: writeAnswerLodgingNumber,
                  lodgingAnswerContent: lodgingAnswerContent
                },
                function () {
                  $("#inputWriteAnswer").val("");
                  getList();
                }
        );
      }

    });

    //ë‹µê¸€ ì‚­ì œë²„íŠ¼
    $("#answerBody").on("click", ".answerRemove", function () {
      if(sessionMemberNumber!=this.classList[3]){
        alert("ì‘ì„±ìê°€ ì•„ë‹ˆë¯€ë¡œ ì‚­ì œ ëª»í•©ë‹ˆë‹¤");
      }
      else {
        console.log("answerRemoveë“¤ì–´ì˜´");
        let lodgingAnswerNumber = this.classList[1];
        console.log(this.classList[1]);
       lodgingAnswerAjax.remove(
               lodgingAnswerNumber,
                function () {
                  getList();
                }
        );
      }
    });

    //ëŒ“ê¸€ ì“°ê¸°ë“±ë¡ë²„íŠ¼
    $("#answerBody").on("click", ".commentWriteButton", function () {




      commentWriteCheck=false;
      let lodgingAnswerNumber = this.classList[1];

      let lodgingAnswerCommentContent=$(this).parent().prev().val();
      console.log("ëŒ“ê¸€ì“°ê¸° ë“±ë¡ë²„íŠ¼"+lodgingAnswerCommentContent);
      if(lodgingAnswerCommentContent==''){
        alert("ì…ë ¥í•œ ë‚´ìš©ì´ ì•„ë¬´ê²ƒë„ ì—†ìŠµë‹ˆë‹¤.");
        return;
      }
      else {
        lodgingCommentAjax.add(
                {
                  lodgingAnswerNumber: lodgingAnswerNumber,
                  lodgingAnswerCommentContent: lodgingAnswerCommentContent
                },
                function () {
                  getList();
                  $(this).parent().prev().val("");
                }
        );
      }
    });

    $("#answerBody").on("click",".commentUpdateButton",function(){
      if(sessionMemberNumber!=this.classList[3]){
        alert("ì‘ì„±ìê°€ ì•„ë‹ˆë¯€ë¡œ ìˆ˜ì • ëª»í•©ë‹ˆë‹¤");
      }
      else if(commentModifyCheck==false && currentModifyingCommentNumber!=this.classList[1]){
        alert("ìˆ˜ì •ì¤‘ì¸ ë‹µê¸€ì´ ìˆìŠµë‹ˆë‹¤.");
        return;
      }
      else if(currentModifyingCommentNumber==0){
        currentModifyingCommentNumber=this.classList[1];
        let lodgingAnswerCommentNumber = this.classList[1];
        commentModifyCheck=false;
        $(".comment-text" + lodgingAnswerCommentNumber).replaceWith("<textarea  style='resize:none;'  class='comment-text comment-text" + lodgingAnswerCommentNumber + "'>" + $(".comment-text" + lodgingAnswerCommentNumber).text() + "</textarea>");
      }
      else{
        lodgingCommentAjax.modify({
          lodgingAnswerCommentNumber:  currentModifyingCommentNumber,
          lodgingAnswerCommentContent: $("textarea.comment-text" + currentModifyingCommentNumber).val()
        }, function () {
          getList();
          commentModifyCheck = true;
        });

        currentModifyingCommentNumber = 0;
      }
    });

    $("#answerBody").on("click",".commentRemoveButton",function(){
      if(sessionMemberNumber!=this.classList[3]){
        alert("ì‘ì„±ìê°€ ì•„ë‹ˆë¯€ë¡œ ì‚­ì œ ëª»í•©ë‹ˆë‹¤");
      }
      else {
        let lodgingAnswerCommentNumber = this.classList[1];

        lodgingCommentAjax.remove(
                lodgingAnswerCommentNumber,
                function () {
                  getList();
                }
        )
      }

    });

  });
</script>



<script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
<script th:inline="javascript">


  let memberNumber=[[${session.memberNumber}]];



</script>
<script src="/js/main/header.js" ></script>

</html>